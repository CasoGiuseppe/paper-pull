
<link rel="import" href="../polymer/polymer.html"/>
<link rel="import" href="../iron-icons/iron-icons.html"/>
<link rel="import" href="../iron-ajax/iron-ajax.html"/>
<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html"/>
<dom-module id="paper-pull">
  <template>
    <style>:host{display:block;font-family:Raleway,serif;font-weight:400}:host::content figure,:host::content h2,:host::content h3,:host::content li,:host::content p,:host::content ul{margin:0;padding:0;list-style:none;font-weight:400}:host::content .paper-pull--builded--wrap{margin:auto;background:red}:host::content .paper-pull--builded--list{position:relative}:host::content .paper-pull--builded--cell{position:absolute;background:#fff;box-shadow:0 0 8px 0 rgba(28,45,206,.6);border-radius:1px;overflow:hidden;transition:all .5s ease-out}@media (max-width:680px){:host::content .paper-pull--builded--cell{position:relative;width:100%;margin-bottom:10px;box-shadow:none}}:host::content .paper-pull--builded--article{width:100%}:host::content .paper-pull--hover{cursor:pointer}:host::content .paper-pull--short--header{width:100%;padding:10px;box-sizing:border-box}:host::content .paper-pull--short--title{font-family:Raleway,serif}:host::content .paper-pull--short--description{width:100%;padding:10px;box-sizing:border-box;font-size:.8em}:host::content .paper-pull--type--picture--wrap{position:relative}:host::content .paper-pull--type--picture--wrap:after{position:absolute;width:100%;height:100%;top:0;left:0;content:'';background:linear-gradient(to bottom,transparent 30%,rgba(0,0,0,.75) 96%,rgba(0,0,0,.67) 100%);transition:background .3s linear}:host::content .paper-pull--type--picture--wrap .paper-pull--short--header{position:absolute;top:50%;z-index:10;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0)}:host::content .paper-pull--type--picture--wrap .paper-pull--short--header *{color:#fff;text-align:center}:host::content .paper-pull--type--picture--wrap .paper-pull--short--description{position:absolute;bottom:0;z-index:10;color:#fff}:host::content .paper-pull--type--picture--wrap.paper-pull--hover:hover img{-webkit-transform:translate3d(0,-20%,0);transform:translate3d(0,-20%,0)}:host::content .paper-pull--type--picture--wrap img{display:block;width:100%;transition:-webkit-transform .3s ease-out;transition:transform .3s ease-out;transition:transform .3s ease-out,-webkit-transform .3s ease-out}:host::content .paper-pull--type--iframe--wrap{position:relative;padding-bottom:56.25%;height:0}:host::content .paper-pull--type--iframe--wrap .paper-pull--type--youtube--wrap{position:absolute;top:0;left:0;width:100%;height:100%}</style>
    <template is="dom-if" if="{{ _isAjax() }}">
      <iron-ajax auto="auto" url="{{ src }}" handle-as="text" on-response="_ajaxResponse"></iron-ajax>
    </template>
    <content></content>
  </template>
  <script>(function(){Polymer({is:"paper-pull",behaviors:[Polymer.IronResizableBehavior],listeners:{"iron-resize":"_onResize"},_get_component:function(){var e,t;return t=this,e=this._get_allAttributes(t),{},this._get_allValues(e)},_get_windowWidth:function(){var e;return e=window.innerWidth,parseFloat(e)},_get_pinColumn:function(){var e,t,i,n,l,s;return l=this.querySelector(".paper-pull--builded--wrap"),s=l.clientWidth,n=this._get_nodeValue(this._get_component(),0,"pinwidth")?parseFloat(this._get_nodeValue(this._get_component(),0,"pinwidth")):this._set_defaultValue("pinWidth"),i=this._get_nodeValue(this._get_component(),0,"pinspace")?parseFloat(this._get_nodeValue(this._get_component(),0,"pinspace")):this._set_defaultValue("pinMargin"),e=this._get_nodeValue(this._get_component(),0,"centered"),t=null!==e&&void 0!==e&&"false"!==e?Math.floor(s/(n+2*i)):Math.floor(s/(n+i)),parseFloat(t)},_get_pinLeftPosition:function(e,t){var i,n;return n=this._get_nodeValue(this._get_component(),"pinwidth")?parseFloat(this._get_nodeValue(this._get_component(),"pinwidth")):this._set_defaultValue("pinWidth"),i=this._get_nodeValue(this._get_component(),"pinspace")?parseFloat(this._get_nodeValue(this._get_component(),"pinspace")):this._set_defaultValue("pinMargin"),i+e*(n+i)+t},_get_allAttributes:function(e){return e.attributes},_get_allAttributeValues:function(e){var t,i,n,l,s,a,r;for(s="",r="",a={},n=i=0,l=e.length;i<l;n=++i)t=e[n],s=t.nodeName,r=t.nodeValue,a[s]=r,console.log(a);return a},_get_nodeValue:function(e,t){var i,n;return i=e,void 0!==(n=null!==t&&void 0!==t?i[t]:i)&&null!==n&&n},_get_nodeExist:function(e,t){var i;return i=[],void 0!==t&&null!==t&&i.push([e,t]),i},_get_propertyExist:function(e,t){return e.hasOwnProperty(t)},_get_minValueInArray:function(e){return Math.min.apply(Math,e)},_get_indexInArray:function(e,t){var i,n,l,s;for(t.length,l=n=0,s=t.length;n<s;l=++n)if(i=t[l],e===parseFloat(i))return l;return!1},_get_allValues:function(e){var t,i,n,l,s,a,r;for(s="",r="",a={},n=i=0,l=e.length;i<l;n=++i)t=e[n],s=t.nodeName,r=t.nodeValue,a[s]=r;return a},_get_externalFile:function(e,t){var i;return this,i=new XMLHttpRequest,i.onreadystatechange=function(){4===i.readyState&&(200===i.status?"function"==typeof t&&t(i.responseText):400===i.status?console.log("not found"):console.log("error"))},i.open("GET",e,!0),i.send(),i},_get_responsive:function(){return this._get_windowWidth()>=parseFloat(this._set_defaultValue("mobile"))},_set_defaultValue:function(e){var t;return t=[{pinWidth:300,pinMargin:0,mobile:680}],t[0][e]},_set_pinConfPosition:function(){var e,t,i,n,l,s,a;for(e=this.querySelectorAll(".paper-pull--builded--cell"),s=this._get_nodeValue(this._get_component(),"pinspace")?parseFloat(this._get_nodeValue(this._get_component(),"pinspace")):this._set_defaultValue("pinMargin"),a=[],t=this._get_pinColumn(),n=i=0,l=e.length;i<l;n=++i)e[n],n<t&&a.push(s);return this._set_pinNewPosition(a)},_set_pinNewPosition:function(e){var t,i,n,l,s,a,r,_,o,u,p,h,d,c,g,f,m,b,v,y,V,w,C;for(n=[],t=[],i=[],w=this.querySelector(".paper-pull--builded--wrap"),s=this.querySelectorAll(".paper-pull--builded--cell"),C=C=w.clientWidth,m=this._get_nodeValue(this._get_component(),"pinwidth")?parseFloat(this._get_nodeValue(this._get_component(),"pinwidth")):this._set_defaultValue("pinWidth"),f=this._get_nodeValue(this._get_component(),"pinspace")?parseFloat(this._get_nodeValue(this._get_component(),"pinspace")):this._set_defaultValue("pinMargin"),a=this._get_nodeValue(this._get_component(),"centered"),y=null!==a&&void 0!==a&&"false"!==a?(C-(m*this._get_pinColumn()+f*(this._get_pinColumn()-1)))/2:0,r=this._get_pinColumn(),o=0,h=s.length;o<h;o++)l=s[o],_=l.clientHeight,V=this._get_nodeValue(this._get_component(),"pinwidth")?parseFloat(this._get_nodeValue(this._get_component(),"pinwidth")):this._set_defaultValue("pinWidth"),g=this._get_minValueInArray(e),u=this._get_indexInArray(g,e),l.style.left=this._get_pinLeftPosition(u,y)+"px",l.style.top=g+"px",l.style.width=V+"px",e[u]=g+_+f,n.push(g),t.push(_);for(v=n.slice(n.length-r,n.length),b=t.slice(t.length-r,t.length),u=p=0,d=v.length;p<d;u=++p)v[u],i.push(v[u]+b[u]);return c=Math.max.apply(null,i),w.style.height=c+f+"px"},_set_attributeCollection:function(e){var t,i;return t=[],i=e,Object.getOwnPropertyNames(i).forEach(function(e,n,l){var s,a;return s=e,a=i[e],t.push([s,a])}),t},_set_attribute:function(e,t,i){var n,l,s,a;for(a=[],n=0,l=e.length;n<l;n++)s=e[n],a.push(s.setAttribute(t(i)));return a},_build_structureWrap:function(e){var t,i,n,l,s,a,r,_,o,u,p,h;for(this,r=this._get_nodeValue(this._get_component(),"wrapwidth")?parseFloat(this._get_nodeValue(this._get_component(),"wrapwidth")):this._get_windowWidth(),h=this._build_element({type:"section",classes:[["paper-pull--builded--wrap"]],styles:[["maxWidth",r+"px"]]}),this.appendChild(h),a=this._build_element({type:"ul",classes:[["paper-pull--builded--list"]]}),u=[],l=n=0,s=e.length;n<s;l=++n)_=e[l],p=_.tagName,this._get_nodeValue(this._get_component(),"pinwidth")?parseFloat(this._get_nodeValue(this._get_component(),"pinwidth")):this._set_defaultValue("pinWidth"),o=this._build_element({type:"li",classes:[["paper-pull--builded--cell"]]}),a.appendChild(o),t=this._build_element({type:"article",classes:[["paper-pull--builded--article"],["paper-pull--type--"+p]],attributes:[["role","contentinfo"],["aria-label","article"]]}),o.appendChild(t),i="_build_"+p,t.appendChild(this[i](o,_)),l===e.length-1&&this.setAttribute("class","loaded"),h.appendChild(a),u.push(this.appendChild(h));return u},_build_default:function(e,t,i){var n,l,s;return this,i=this._get_nodeValue(t,"tagName"),s=this._build_element({type:"div",classes:[["paper-pull--type--"+i+"--wrap"]]}),l=this._build_relatedContent("header",t,"header"),l&&s.appendChild(l),n=this._build_relatedContent("description",t,"p"),n&&s.appendChild(n),s},_build_picture:function(e,t){var i,n,l,s,a,r,_,o,u,p;return l=this,n=this._get_nodeValue(t,"aria-labelledby"),o=this._get_nodeValue(t,"src"),p=this._get_nodeValue(t,"tagName"),u=this._build_element({type:"figure",classes:[["paper-pull--type--"+p+"--wrap"]],attributes:[["aria-labelledby",n]]}),this._remove_node(t,"aria-labelledby"),r=this._build_relatedContent("header",t,"header"),r&&u.appendChild(r),a=this._build_relatedContent("description",t,"figcaption"),a&&u.appendChild(a),s=this._build_content(t),_=new Image,_.onload=function(){if(s.src=this.src,l._get_responsive())return setTimeout(function(){l._set_pinConfPosition()},400)},_.src=o,u.appendChild(s),this._get_nodeValue(t,"href")&&(i=this._build_element({type:"a",attributes:[["href",this._get_nodeValue(t,"href")],["target","_blank"]]}),i.appendChild(u),u=i),u},_build_youtube:function(e,t){var i,n,l,s,a,r,_;return this,a=this._get_nodeValue(t,"tagName"),r=this._get_nodeValue(t,"video"),n=r.replace("/watch?v=","/embed/"),i=this._get_nodeValue(t,"aria-labelledby"),l=r.indexOf("youtube.com/watch?v=")>-1?n+"?autoplay=0":r+"?autoplay=0",_=this._build_element({type:"div",classes:[["paper-pull--type--iframe--wrap"]]}),s=this._build_element({type:"iframe",classes:[["paper-pull--type--"+a+"--wrap"]],attributes:[["aria-labelledby",i],["frameborder","0"],["allowfullscreen",""],["src",l]]}),_.appendChild(s),_},_build_content:function(e){var t;return t=this._get_nodeValue(e,"tagName"),this._remove_node(e,"tagName"),this._build_element({type:this._replace_tag(t),attributes:this._set_attributeCollection(e)})},_build_relatedContent:function(e,t,i){var n;return n="_build_related_"+e,this[n](e,t,i)},_build_related_header:function(e,t,i){var n,l;return!(!this._get_nodeValue(t,"title")&&!this._get_nodeValue(t,"claim"))&&(l=this._build_element({type:i,classes:[["paper-pull--short--"+e]]}),this._get_nodeValue(t,"title")&&(n=this._build_element({type:"h2",classes:[["paper-pull--short--title"]],content:this._get_nodeValue(t,"title")}),l.appendChild(n),this._remove_node(t,"title")),this._get_nodeValue(t,"claim")&&(n=this._build_element({type:"h3",classes:[["paper-pull--short--claim"]],content:this._get_nodeValue(t,"claim")}),l.appendChild(n),this._remove_node(t,"claim")),l)},_build_related_description:function(e,t,i){var n;return!!this._get_nodeValue(t,"description")&&(n=this._build_element({type:i,classes:[["paper-pull--short--"+e]],content:this._get_nodeValue(t,"description")}),this._remove_node(t,"description"),n)},_build_element:function(e){var t,i,n,l,s,a,r,_,o,u,p;if(t=document.createElement(e.type),null!==e.classes&&void 0!==e.classes)for(o=e.classes,n=i=0,a=o.length;i<a;n=++i)o[n],t.className+=e.classes[n]+" ";if(null!==e.attributes&&void 0!==e.attributes)for(u=e.attributes,n=l=0,r=u.length;l<r;n=++l)u[n],null!==e.attributes[n][1]&&void 0!==e.attributes[n][1]&&t.setAttribute(e.attributes[n][0],e.attributes[n][1]);if(null!==e.content&&void 0!==e.content&&(t.innerHTML=e.content),null!==e.styles&&void 0!==e.styles)for(p=e.styles,n=s=0,_=p.length;s<_;n=++s)p[n],t.style[e.styles[n][0]]=e.styles[n][1];return t},_replace_tag:function(e){var t;switch(e){case"picture":t="img";break;case"default":t="p"}return t},_remove_node:function(e,t){return delete e[t]},_remove_attr:function(e,t){var i,n,l,s;for(s=[],i=0,n=e.length;i<n;i++)l=e[i],s.push(l.removeAttribute(t));return s},attached:function(){var e;return e=this,this._get_externalFile(this._get_nodeValue(this._get_component(),"source"),function(t){var i;return i=JSON.parse(t),e._build_structureWrap(i.pins)})},ready:function(){},_onLoad:function(){},_onResize:function(){var e,t;return t=this,console.log(this._get_responsive()),this._get_responsive()?t.classList.contains("loaded")?this._set_pinConfPosition():void 0:(e=this.querySelectorAll(".paper-pull--builded--cell"),this._remove_attr(e,"style"))},_test:function(){var e;return e=[],e.push(this),this._get_externalFile(this._get_nodeValue(this._get_component(),"source"),function(e){var t;return t=JSON.parse(e),t.pins[0]})}})}).call(this);</script>
</dom-module>